ungroup()
# Make wide format for scatter
potentialforest_wide <- potentialforest_norm %>%
pivot_wider(names_from = Type, values_from = Value_norm)
# Scatter plot
ggplot(potentialforest_wide, aes(x = Potential_forestregeneration_total,
y = Reforestation_carbonseq_total,
label = iso3)) +
geom_point(color = "#1f77b4", size = 4) +
geom_text(nudge_y = 0.03, size = 3) +
labs(
x = "Potential Forest Regeneration (normalized)",
y = "Reforestation Potential (normalized)",
title = "Normalized Comparison: Forest Regeneration vs Carbon Sequestration Potential"
) +
theme_minimal()
potentialforest_db <- restoration_db %>%
filter(Variable %in% c("Reforestation_carbonseq_total", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("BRA", "IDN", "COL", "MEX", "COD", "CHN")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
select(iso3, Reforestation_carbonseq_total, Potential_forestregeneration_total) %>%
pivot_longer(
cols = c(Reforestation_carbonseq_total, Potential_forestregeneration_total),
names_to = "Type",
values_to = "Value"
)
labels_map <- c(
"IDN" = "Indonesia",
"COD" = "DR Congo",
"CHN" = "China",
"USA" = "United States",
"MEX" = "Mexico",
"BRA" = "Brazil",
"COL" = "Colombia"
)
potentialforest_db
# Cleaning datasets and merging them into one, so that country-level comparison and analysis is possible
#Library
library(readxl)
library(tidyverse)
library(shinyBS)
library(shinyWidgets)
library(rintrojs)
library(latex2exp)
library(scales)
library(ggplot2)
library(gridExtra)
library(here)
library(openxlsx)
library(writexl)
library(gridExtra)
library(grid)
library(cowplot)
library(ggbreak)
library(ggprism)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(sf)
library(geojsonsf)
here()
# Aboveground and Belowground Biomass Carbon Density for the year 2010
Aboveground_and_Belowground_Biomass_Carbon_Density_Zonal_Statistics <- read_csv(here("data/input/Aboveground_and_Belowground_Biomass_Carbon_Density_Zonal_Statistics.csv")) %>%
group_by(iso3) %>%
summarise(
country_area = sum(area, na.rm = TRUE),
Biomass_Carbon_Density = sum(`sum`, na.rm = TRUE) / country_area,
Biomass_Carbon = sum(`sum`, na.rm = TRUE)
) %>%
pivot_longer(
cols = c(Biomass_Carbon_Density, country_area, Biomass_Carbon),
names_to = "Variable",
values_to = "Value"
) %>%
mutate(
unit = case_when(
Variable == "Biomass_Carbon_Density" ~ "Mg/ha",
Variable == "country_area" ~ "ha",
Variable == "Biomass_Carbon" ~ "Mg"
),
source = "Aboveground_and_Belowground_Biomass_Carbon_Density",
description = case_when(
Variable == "Biomass_Carbon_Density" ~ "Aboveground and Belowground Biomass Carbon Density",
Variable == "Biomass_Carbon" ~ "Aboveground and Belowground Total Biomass Carbon",
Variable == "country_area" ~ "Area of the country"
)
) %>%
select(iso3, Variable, Value, unit, description, source)
# Global tree cover (existing and potential)
Bastin_Zonal_Statistics <- read_csv(here("data/input/Bastin_Zonal_Statistics.csv")) %>%
group_by(iso3) %>%
summarise(
country_area = sum(area, na.rm = TRUE),
Tree_cover = sum(`mean` * area, na.rm = TRUE) / sum(area, na.rm = TRUE),
Tree_cover_ha = sum(`mean` * area, na.rm = TRUE) / 100
) %>%
pivot_longer(
cols = c(Tree_cover, Tree_cover_ha, country_area),
names_to = "Variable",
values_to = "Value"
) %>%
mutate(
unit = case_when(
Variable == "Tree_cover" ~ "%",
Variable == "Tree_cover_ha" ~ "ha",
Variable == "country_area" ~ "ha"
),
source = "Bastinetal_2019",
description = case_when(
Variable == "Tree_cover" ~ "Global tree cover (existing and potential, % of land)",
Variable == "Tree_cover_ha" ~ "Global tree cover (existing and potential, hectares)",
Variable == "country_area" ~ "Area of the country (hectares)"
)
) %>%
select(iso3, Variable, Value, unit, description, source)
# Aboveground_and_Belowground_Biomass_Carbon_Density_Zonal_Statistics and Bastin_Zonal_Statistics have the same structure
# => possible graph indicating corremation between tree coverage and carbon density
# Indian restoration areas
Chaturvedi_ZonalStatistics <- read_csv(here("data/input/Chaturvedi _ZonalStatistics.csv")) %>%
mutate(
iso3 = "IND",
source = "Chaturvedietal_2018"
) %>%
rename(
"Excluded_areas" = "0",
"Protection" = "1",
"Wide_scale_Restoration" = "2",
"Mosaic_Restoration" = "3"
) %>%
summarise(
Excluded_areas = sum(Excluded_areas, na.rm = TRUE),
Protection = sum(Protection, na.rm = TRUE),
Wide_scale_Restoration = sum(Wide_scale_Restoration, na.rm = TRUE),
Mosaic_Restoration = sum(Mosaic_Restoration, na.rm = TRUE)
) %>%
mutate(
iso3 = "IND",
unit = "ha",
source = "Chaturvedietal_2018"
) %>%
pivot_longer(
cols = c(Excluded_areas, Protection, Wide_scale_Restoration, Mosaic_Restoration),
names_to = "Variable",
values_to = "Value"
) %>%
mutate(
description = case_when(
Variable == "Excluded_areas" ~ "Excluded areas",
Variable == "Protection" ~ "Protection",
Variable == "Wide_scale_Restoration" ~ "Wide-scale Restoration",
Variable == "Mosaic_Restoration" ~ "Mosaic Restoration"
)
) %>%
select(iso3, Variable, Value, unit, description, source)
# Carbon sequestration potential from reforestation in CO2e
Griscom_Zonal_Statistics <- read_csv(here("data/input/Griscom_Zonal_Statistics.csv")) %>%
group_by(iso3) %>%
summarise(
country_area = sum(area, na.rm = TRUE),
Reforestation_carbonseq_total = sum(`sum`, na.rm = TRUE),
Reforestation_carbonseq_density = sum(`sum`, na.rm = TRUE) / country_area
) %>%
pivot_longer(
cols = c(Reforestation_carbonseq_density, Reforestation_carbonseq_total, country_area),
names_to = "Variable",
values_to = "Value"
) %>%
mutate(
unit = case_when(
Variable == "Reforestation_carbonseq_density" ~ "kgCO2e ha-1 yr-1",
Variable == "Reforestation_carbonseq_total" ~ "kgCO2e yr-1",
Variable == "country_area" ~ "ha"
),
description = case_when(
Variable == "Reforestation_carbonseq_density" ~ "Density of carbon sequestration potential from reforestation",
Variable == "Reforestation_carbonseq_total" ~ "Total carbon sequestration potential from reforestation",
Variable == "country_area" ~ "Area of the country"
),
source = "Griscometal_2017"
) %>%
select(iso3, Variable, Value, unit, description, source)
# Net Climate Impact of tree cover restoration (carbon storage and albedo change)
Hasler_Zonal_Statistics <- read_csv(here("data/input/Hasler_Zonal_Statistics.csv")) %>%
group_by(iso3) %>%
summarise(
country_area = sum(area, na.rm = TRUE),
ClimateImpact_treecoverrestoration_total = sum(`sum`, na.rm = TRUE),
ClimateImpact_treecoverrestoration_density = sum(`sum`, na.rm = TRUE) / country_area
) %>%
pivot_longer(
cols = c(ClimateImpact_treecoverrestoration_total, ClimateImpact_treecoverrestoration_density, country_area),
names_to = "Variable",
values_to = "Value"
) %>%
mutate(
unit = case_when(
Variable == "ClimateImpact_treecoverrestoration_total" ~ "Mg CO2e",
Variable == "ClimateImpact_treecoverrestoration_density" ~ "Mg CO2e ha-1",
Variable == "country_area" ~ "ha"
),
description = case_when(
Variable == "ClimateImpact_treecoverrestoration_total" ~ "Net Climate Impact of tree cover restoration (carbon storage and albedo change)",
Variable == "ClimateImpact_treecoverrestoration_density" ~ "Density of Net Climate Impact of tree cover restoration (carbon storage and albedo change) per hectare",
Variable == "country_area" ~ "Area of the country"
),
source = "Hasleretal_2024"
) %>%
select(iso3, Variable, Value, unit, source, description)
# Constrained unrealized potential aboveground biomass, belowground biomass, and soil organic carbon combined density under baseline climate
Walker_Zonal_Statistics <- read_csv(here("data/input/Walker_Zonal_Statistics.csv")) %>%
group_by(iso3) %>%
summarise(
country_area = sum(area, na.rm = TRUE),
Potential_carbonland_total = sum(`sum`, na.rm = TRUE),
Potential_carbonland_density = sum(`sum`, na.rm = TRUE) / country_area
) %>%
pivot_longer(
cols = c(Potential_carbonland_total, Potential_carbonland_density, country_area),
names_to = "Variable",
values_to = "Value"
) %>%
mutate(
unit = case_when(
Variable == "Potential_carbonland_total" ~ "Mg C",
Variable == "Potential_carbonland_density" ~ "Mg C ha-1",
Variable == "country_area" ~ "ha"
),
description = case_when(
Variable == "Potential_carbonland_total" ~ "Total constrained unrealized potential aboveground biomass, belowground biomass, and soil organic carbon under baseline climate",
Variable == "Potential_carbonland_density" ~ "Density of constrained unrealized potential aboveground biomass, belowground biomass, and soil organic carbon under baseline climate",
Variable == "country_area" ~ "Area of the country"
),
source = "Walkeral_2022"
) %>%
select(iso3, Variable, Value, unit, description, source)
# Potential for forest regeneration in tropical regions
Williams_Zonal_Statistics <- read_csv(here("data/input/Williams_Zonal_Statistics.csv")) %>%
group_by(iso3) %>%
summarise(
country_area = sum(area, na.rm = TRUE),
Potential_forestregeneration_total = sum(`sum`, na.rm = TRUE),
Potential_forestregeneration_percent = 100 * sum(`sum`, na.rm = TRUE) / country_area
) %>%
pivot_longer(
cols = c(Potential_forestregeneration_total, Potential_forestregeneration_percent, country_area),
names_to = "Variable",
values_to = "Value"
) %>%
mutate(
Value = ifelse(Variable == "Potential_forestregeneration_percent",
round(Value, 2),
Value),
unit = case_when(
Variable == "Potential_forestregeneration_total" ~ "ha",
Variable == "Potential_forestregeneration_percent" ~ "%",
Variable == "country_area" ~ "ha"
),
description = case_when(
Variable == "Potential_forestregeneration_total" ~ "Total potential for forest regeneration in tropical regions",
Variable == "Potential_forestregeneration_percent" ~ "Share of country area with potential for forest regeneration (%)",
Variable == "country_area" ~ "Area of the country"
),
source = "Williamsal_2024"
) %>%
select(iso3, Variable, Value, unit, description, source)
# Data are correct => compared with the paper results
restoration_db <- Aboveground_and_Belowground_Biomass_Carbon_Density_Zonal_Statistics %>%
rbind(Bastin_Zonal_Statistics) %>%
rbind(Chaturvedi_ZonalStatistics) %>%
rbind(Griscom_Zonal_Statistics) %>%
rbind(Hasler_Zonal_Statistics) %>%
rbind(Walker_Zonal_Statistics) %>%
rbind(Williams_Zonal_Statistics) %>%
distinct(iso3, Variable, .keep_all = TRUE) %>%
drop_na()
### IDEA OF ANALYSIS ###
### Databases we have:
# Global tree cover (existing and potential)
# Indian restoration areas
# Carbon sequestration potential from reforestation in CO2e
# Net Climate Impact of tree cover restoration (carbon storage and albedo change)
# Constrained unrealized potential aboveground biomass, belowground biomass, and soil organic carbon combined density under baseline climate
# Potential for forest regeneration in tropical regions
### 1) Compare "Carbon sequestration potential from reforestation in CO2e" and "Net Climate Impact of tree cover restoration (carbon storage and albedo change)"
### 2) Compare "Indian restoration areas" (put them on a stacked column, without the excluded areas + compare with "Aboveground and Belowground Biomass Carbon Density" for India)
### 3) Compare "Potential for forest regeneration in tropical regions" vs  Global tree cover (existing and potential)
### 1) Compare "Aboveground and Belowground Biomass Carbon Density" and "Constrained unrealized potential aboveground biomass, belowground biomass, and soil organic carbon combined density under baseline climate"
# Aboveground and Belowground Biomass Carbon Density => Biomass_Carbon
# Constrained unrealized potential aboveground biomass, belowground biomass, and soil organic carbon combined density under baseline climate => Potential_carbonland_total
# Current Carbon Stock (above and below biomass)" vs Unrealized Potential Carbon Stock (above and below biomass + SOC)
biomass_db <- restoration_db %>%
filter(Variable %in% c("Biomass_Carbon", "Potential_carbonland_total")) %>%
filter(iso3 %in% c("BRA", "RUS", "USA", "CAN", "COD", "IDN", "CHN")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
select(iso3, Biomass_Carbon, Potential_carbonland_total) %>%
pivot_longer(
cols = c(Biomass_Carbon, Potential_carbonland_total),
names_to = "Type",
values_to = "Value"
)
labels_map <- c(
"IDN" = "Indonesia",
"COD" = "DR Congo",
"CHN" = "China",
"USA" = "United States",
"RUS" = "Russia",
"BRA" = "Brazil",
"CAN" = "Canada"
)
labels_map_type <- c(
"Biomass_Carbon" = "Current Carbon Stock (above and below biomass)",
"Potential_carbonland_total" = "Unrealized Potential Carbon Stock (above and below biomass + SOC)"
)
biomass_plot <- ggplot(biomass_db, aes(x = iso3, y = Value / 1e9, fill = Type)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::comma) +
labs(
x = "",
y = "Carbon Stock (Pg C)",
fill = "",
title = "Current vs Unrealized Potential Carbon Stock by Country"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_x_discrete(labels = labels_map) +
scale_fill_manual(values = c("Biomass_Carbon" = "#1f77b4",
"Potential_carbonland_total" = "#ff7f0e"),
labels = labels_map_type)
### 3) Compare "Potential for forest regeneration in tropical regions" vs  Global tree cover (existing and potential)
# Potential forests reg in tropical regions
treecover_top6 <- restoration_db %>%
filter(Variable == "Potential_forestregeneration_total") %>%
arrange(desc(Value)) %>%
slice_head(n = 6)
forestcover_db <- restoration_db %>%
filter(Variable %in% c("Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("BRA", "IDN", "COL", "MEX", "COD", "CHN")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
select(iso3, Tree_cover_ha, Potential_forestregeneration_total) %>%
pivot_longer(
cols = c(Tree_cover_ha, Potential_forestregeneration_total),
names_to = "Type",
values_to = "Value"
)
labels_map <- c(
"IDN" = "Indonesia",
"COD" = "DR Congo",
"CHN" = "China",
"USA" = "United States",
"MEX" = "Mexico",
"BRA" = "Brazil",
"COL" = "Colombia"
)
labels_map_type <- c(
"Tree_cover_ha" = "Current Tree Cover (Mha)",
"Potential_forestregeneration_total" = "Potential Forest Regeneration (Mha)"
)
forestcover_plot <- ggplot(forestcover_db, aes(x = iso3, y = Value / 1e6, fill = Type)) +
geom_col(position = "dodge") +
scale_y_continuous(labels = scales::comma) +
labs(
x = "",
y = "Forest cover & Potential (Mha)",
fill = "",
title = "Current Tree Cover vs Potential Forest Regeneration"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_x_discrete(labels = labels_map) +
scale_fill_manual(values = c("Tree_cover_ha" = "#1f77b4",
"Potential_forestregeneration_total" = "#ff7f0e"),
labels = labels_map_type)
### 3) Compare "Potential for forest regeneration in tropical regions" vs  Total carbon sequestration potential from reforestation
potentialforest_db <- restoration_db %>%
filter(Variable %in% c("Reforestation_carbonseq_total", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("BRA", "IDN", "COL", "MEX", "COD", "CHN")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
select(iso3, Reforestation_carbonseq_total, Potential_forestregeneration_total) %>%
pivot_longer(
cols = c(Reforestation_carbonseq_total, Potential_forestregeneration_total),
names_to = "Type",
values_to = "Value"
)
View(potentialforest_db)
potentialforest_ratio_db <- restoration_db %>%
filter(Variable %in% c("Reforestation_carbonseq_total", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("BRA", "IDN", "COL", "MEX", "COD", "CHN")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
mutate(Reforestation_ratio = Reforestation_carbonseq_total / Potential_forestregeneration_total)  # MtCO2e / Mha
# Labels for countries
labels_map <- c(
"IDN" = "Indonesia",
"COD" = "DR Congo",
"CHN" = "China",
"USA" = "United States",
"MEX" = "Mexico",
"BRA" = "Brazil",
"COL" = "Colombia"
)
# Plot ratio
potentialforest_ratio_plot <- ggplot(potentialforest_ratio_db, aes(x = iso3, y = Reforestation_ratio)) +
geom_col(fill = "#1f77b4") +
scale_y_continuous(labels = scales::comma) +
labs(
x = "",
y = "Reforestation potential per hectare (Mt CO₂e / Mha)",
title = "Carbon sequestration potential per hectare of potential forest regeneration"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_x_discrete(labels = labels_map)
potentialforest_ratio_plot
potentialforest_ratio_db <- restoration_db %>%
filter(Variable %in% c("Reforestation_carbonseq_total", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("BRA", "IDN", "COL", "MEX", "COD", "CHN")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
mutate(Reforestation_ratio = Reforestation_carbonseq_total / Potential_forestregeneration_total)
View(potentialforest_ratio_db)
View(restoration_db)
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide-scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
select(iso3, Variable, Value)
View(Indiaforest_db)
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide-scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("IND")) %>%
select(iso3, Variable, Value)
View(Indiaforest_db)
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide_scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("IND")) %>%
select(iso3, Variable, Value)
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide_scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("IND")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
pivot_longer(
cols = c(Excluded_areas, Protection, Wide_scale_Restoration, Mosaic_Restoration, Tree_cover_ha, Potential_forestregeneration_total),
names_to = "Type",
values_to = "Value"
)
Indiaforest_db
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide_scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("IND")) %>%
select(iso3, Variable, Value)
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide_scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("IND")) %>%
select(iso3, Variable, Value) %>%
pivot_wider(names_from = Variable, values_from = Value) %>%
pivot_longer(
cols = c(Excluded_areas, Protection, Wide_scale_Restoration, Mosaic_Restoration, Tree_cover_ha, Potential_forestregeneration_total),
names_to = "Type",
values_to = "Value"
)
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide_scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("IND")) %>%
select(iso3, Variable, Value)
Indiaforest_db <- restoration_db %>%
filter(Variable %in% c("Excluded_areas", "Protection", "Wide_scale_Restoration", "Mosaic_Restoration", "Tree_cover_ha", "Potential_forestregeneration_total")) %>%
filter(iso3 %in% c("IND")) %>%
select(iso3, Variable, Value)
Indiaforest_stacked <- Indiaforest_db %>%
mutate(Group = case_when(
Variable %in% c("Excluded_areas", "Protection", "Wide_scale_Restoration", "Mosaic_Restoration") ~ "Restoration_types",
Variable == "Tree_cover_ha" ~ "Tree_cover",
Variable == "Potential_forestregeneration_total" ~ "Potential_forest_regeneration"
)) %>%
mutate(Value = Value / 1e6) %>%
arrange(Group)
# Now plot
ggplot(Indiaforest_stacked, aes(x = Group, y = Value, fill = Variable)) +
geom_col(position = ifelse(Indiaforest_stacked$Group == "Restoration_types", "stack", "dodge")) +
labs(
x = "",
y = "Area (Mha)",
fill = "",
title = "India: Current Tree Cover, Potential Forest Regeneration, and Restoration Types"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Now plot
ggplot(Indiaforest_stacked, aes(x = Group, y = Value, fill = Variable)) +
geom_col(position = "stack") +  # stack all by default
labs(
x = "",
y = "Area (Mha)",
fill = "",
title = "India: Current Tree Cover, Potential Forest Regeneration, and Restoration Types"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Now plot
ggplot(Indiaforest_stacked, aes(x = Group, y = Value, fill = Variable)) +
geom_col(position = "stack") +
labs(
x = "",
y = "Area (Mha)",
fill = "",
title = "India: Current Tree Cover (actual and potential), Potential Forest Regeneration, and Restoration Types"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
